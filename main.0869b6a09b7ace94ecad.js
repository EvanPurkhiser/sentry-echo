webpackJsonp([1],{"./node_modules/css-loader/index.js!./node_modules/sass-loader/lib/loader.js!./src/index.scss":function(e,t,n){t=e.exports=n("./node_modules/css-loader/lib/css-base.js")(void 0),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Raleway:100,200,300);",""]),t.i(n("./node_modules/css-loader/index.js!./node_modules/platformicons/platformicons/platformicons.css"),""),t.i(n("./node_modules/css-loader/index.js!./node_modules/typeface-rubik/index.css"),""),t.push([e.i,'.platform-icon:before{height:50px;width:50px;font-family:platformicons;color:#fff;font-size:32px;-webkit-font-smoothing:antialiased;display:block;height:100%;border-radius:3px 0 0 3px;text-align:center;line-height:48px}.c:before{content:"C";font-family:Raleway;font-weight:300;background:#a9b9cb;line-height:50px}.cocoa:before{content:"\\E60A";background:red}.csharp:before{content:"\\E60F";background:#0090ff}.elixir:before{content:"\\E903";background:#4e3fb4}.go:before{content:"\\E606";background:#fff;color:#000}.java:before{content:"\\E608";background:#ff8a00}.javascript:before{content:"\\E600";background:#ffd906}.node:before{content:"\\E609";background:#8ac655}.objc:before{content:"\\E60E";background:#02bfd0}.php:before{content:"\\E601";background:#4f5b93}.python:before{content:"\\E602";background:#3776ab}.ruby:before{content:"\\E604";background:#d00202}.perl:before{content:"\\E901";background:#9d95a4}.other:before{content:"\\E60A";background:#afafaf}#root,body,html{height:100%}#root,#sentry_echo,body{min-height:100%;margin:0;padding:0}body{background:#15121c;color:#fff;font-family:Rubik;font-weight:300}#sentry_echo,header{display:flex;flex-direction:column}header{flex-grow:0;padding:20px 0;text-align:center}header p{padding-top:25px;width:570px;line-height:1.9em;margin:0 auto;font-size:.9rem;color:#fff;animation:flavorText 10s linear 1 forwards}@keyframes flavorText{50%{opacity:1}to{opacity:.25}}.logo{display:flex;font-family:Raleway;margin:0 auto}.logo h1:first-child{width:200px;height:70px;background:url("https://sentry-brand.storage.googleapis.com/sentry-logo-white.svg") no-repeat;text-indent:-9999px}.logo h1:last-child{font-weight:100;text-transform:lowercase;line-height:68px;position:relative}.main-app{position:relative;flex-grow:1;display:flex;justify-content:center;padding-top:80px}.sequencers{list-style:none;margin:0;padding:0}.sequencers li:not(:last-child){margin-bottom:8px}.platform{display:flex;width:800px}.instrument-heading{display:flex;text-transform:uppercase;font-size:.8rem;align-items:center;padding:4px 0;user-select:none}.instrument-heading:after{content:"";border-bottom:1px solid #333;flex-grow:1;margin-left:10px}.note-indicator{display:block;width:4px;background:#353042;margin-left:6px;animation:none}.note-indicator.trigger{animation:noteIndicatorTrigger .3s}@keyframes noteIndicatorTrigger{20%{background:#e03e2f}}.sequence-timeline{overflow:hidden;position:relative;margin-left:6px;background:hsla(0,0%,100%,.01);flex-grow:1}.sequence-timeline svg{display:block;shape-rendering:crispEdges}.sequence-timeline svg .bar-lines line{stroke-width:1px;stroke:#2a2140}.sequence-timeline svg .playlist rect{fill:#9990ab}.playhead{top:0;left:0;border-right:1px solid #6c5fc7;transform:translateX(0);opacity:0;transition:opacity .1s;z-index:2}.playhead,.playhead:before{position:absolute;height:100%}.playhead:before{content:"";display:block;width:10px;left:-10px;background:linear-gradient(90deg,rgba(108,95,199,0),rgba(108,95,199,.2))}.playhead.shown{opacity:1}.bpm-indicator{position:absolute;top:10px;font-weight:400;font-size:1.2rem;line-height:1.2rem;text-align:center;color:#f58159;transition:opacity .6s,transform .6s;opacity:0;transform:translateY(47px);pointer-events:none}.bpm-indicator.ready{opacity:1;transform:translateY(0)}.bpm-indicator div,.bpm-indicator small{color:#fff;font-weight:100}.bpm-indicator small{font-size:.65rem;margin-left:2px}.bpm-indicator div{font-size:.8rem;opacity:.6}.loading-sequence{position:absolute;top:20px;background:#e03e2f;font-size:.8rem;padding:5px 10px;border-radius:3px;animation:waitNotify 1s;transition:opacity .6s}.loading-sequence.ready{opacity:0;pointer-events:none}@keyframes waitNotify{0%{opacity:0}60%{opacity:0}to{opacity:1}}',""])},"./src/App.js":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var n=[],a=!0,o=!1,r=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){o=!0,r=e}finally{try{!a&&s.return&&s.return()}finally{if(o)throw r}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=n("./node_modules/react/index.js"),c=a(d),u=n("./node_modules/tone/build/Tone.js"),f=a(u),p=n("./node_modules/classnames/index.js"),h=a(p),m=n("./node_modules/animejs/anime.min.js"),g=a(m),y=n("./node_modules/react-animated-number/build/index.js"),b=a(y),v=n("./node_modules/lodash/lodash.js"),x=a(v);n("./src/index.scss");var w=["javascript","node","python","ruby","cocoa","csharp","elixir","go","java","objc","php","perl","c","other"];f.default.Transport.start("+1"),f.default.Transport.bpm.value=160,window.Tone=f.default;var k=["Lead Synth","Kick Drum","Bass Line"],E=["C","D","E","F","G","A","B"],S=[["javascript","node","python","ruby"],["go","csharp","elixir","php"],["java","objc","c","other"]],_=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"makeBarGrid",value:function(){var e=this,t=new f.default.Time("1:0:0").div(this.props.sequenceSize).mult(this.props.width).toSeconds(),n=Math.floor(this.props.width/t);return x.default.times(n,function(n){return c.default.createElement("line",{key:n,x1:Math.floor(t*(n+1)),x2:Math.floor(t*(n+1)),y1:0,y2:e.props.height})})}},{key:"makeNote",value:function(e){var t=this.props.height/E.length-4,n=e.length.clone().div(this.props.sequenceSize).mult(this.props.width).toSeconds(),a=Math.max(1,n),o=e.relTime.clone().div(this.props.sequenceSize).mult(this.props.width).toSeconds()+1,r=Math.floor(e.scaleIndex*(this.props.height/E.length))+2;return c.default.createElement("rect",{key:e.time.toSeconds(),height:t,width:a,x:o,y:r})}},{key:"makePlaylist",value:function(){var e=this;return this.props.playlist.map(function(t){return e.makeNote(t)})}},{key:"render",value:function(){return c.default.createElement("svg",{width:this.props.width,height:this.props.height},c.default.createElement("g",{className:"bar-lines"},this.makeBarGrid()),c.default.createElement("g",{className:"playlist"},this.makePlaylist()))}}]),t}(d.Component);_.defaultProps={playlist:[]};var j=function(e){function t(){o(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={sequenceSize:new f.default.Time("4:0:0"),playheadShown:!1,countDivision:5,noteLength:"64n",quantizeTo:"8n"},e.timeline=null,e.playhead=null,e.playheadAnim=null,e.beatIndicator=null,e.setPlayhead=e.setPlayhead.bind(e),e.processEvents=e.processEvents.bind(e),e.triggerNoteIndicator=e.triggerNoteIndicator.bind(e),e.updatePlaylist=e.updatePlaylist.bind(e),e}return i(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this.state.sequenceSize;new f.default.Loop(this.processEvents,this.state.sequenceSize).start(e)}},{key:"processEvents",value:function(e){var t=this,n=this.props.eventBuffer[this.props.platform].sort();this.props.eventBuffer[this.props.platform]=[];var a=n[0];n=n.map(function(e){return new f.default.Time((e-a)/1e3)}),n=n.map(function(e){return e.quantize(t.state.quantizeTo)});var o=Object.values(x.default.groupBy(n,function(e){return e.toSeconds()}));n=o.map(function(n){return{relTime:n[0],time:n[0].clone().add(e),length:new f.default.Time(n.length/t.state.countDivision).mult(t.state.noteLength)}});var r=Math.floor(Math.random()*(E.length-1));n[0].scaleIndex=r;for(var i=1;i<n.length;i++){var s=n[i],l=n[i-1],d=[-1,1][Math.floor(2*Math.random())];s.scaleIndex=l.time.clone().add(l.length)>s.time?r=Math.abs(r+d)%E.length:r}n.forEach(function(e){return f.default.Draw.schedule(t.triggerNoteIndicator,e.time)}),f.default.Draw.schedule(function(e){return t.updatePlaylist(n)},e)}},{key:"updatePlaylist",value:function(e){this.setState({playlist:e}),this.setPlayhead()}},{key:"triggerNoteIndicator",value:function(){var e=this;this.noteIndicator.classList.remove("trigger"),setTimeout(function(t){return e.noteIndicator.classList.add("trigger")},1)}},{key:"setPlayhead",value:function(){if(this.setState({playheadShown:!0}),null!==this.playheadAnim)return void this.playheadAnim.restart();this.playheadAnim=(0,g.default)({targets:this.playhead,duration:this.state.sequenceSize.toMilliseconds(),translateX:this.timeline.clientWidth,easing:"linear"})}},{key:"render",value:function(){var e=this;return console.log("okay re-rendering"),c.default.createElement("li",{className:"platform"},c.default.createElement("span",{className:(0,h.default)("platform-icon",this.props.platform)}),c.default.createElement("span",{className:"note-indicator",ref:function(t){return e.noteIndicator=t}}),c.default.createElement("div",{className:"sequence-timeline",ref:function(t){return e.timeline=t}},c.default.createElement("span",{className:(0,h.default)("playhead",{shown:this.state.playheadShown}),ref:function(t){return e.playhead=t}}),c.default.createElement(_,{playlist:this.state.playlist,sequenceSize:this.state.sequenceSize,width:734,height:48})))}}]),t}(d.Component),q=c.default.createElement("header",null,c.default.createElement("div",{className:"logo"},c.default.createElement("h1",null,"Sentry"),c.default.createElement("h1",null,"Echo")),c.default.createElement("p",null,"Listen the beautiful soundscape generated by software breaking around the world. Hear the sound of errors — Powered by sentry.io")),P=[(new f.default.PluckSynth).toMaster(),(new f.default.MembraneSynth).toMaster(),(new f.default.AMSynth).toMaster()],z=function(e){function t(){o(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={globalSequenceSize:new f.default.Time("4:0:0"),ordering:x.default.cloneDeep(S),bpmDivider:6,currentBpm:new Number(0),eventsPerSecond:new Number(0)},e.eventBuffer=x.default.fromPairs(w.map(function(e){return[e,[]]})),e.eventsPerSequence=0,e.starting=e.starting.bind(e),e.recomputeBpm=e.recomputeBpm.bind(e),e}return i(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this;this.props.eventStream.onmessage=this.processEvents.bind(this);var t=this.state.globalSequenceSize;f.default.Transport.schedule(function(t){return f.default.Draw.schedule(e.starting,t)},t);var n=t.clone().sub("1t");new f.default.Loop(this.recomputeBpm,this.state.globalSequenceSize).start(n)}},{key:"processEvents",value:function(e){var t=JSON.parse(e.data),n=s(t,4),a=(n[0],n[1],n[2]),o=n[3];void 0!==this.eventBuffer[o]&&(this.eventsPerSequence++,this.eventBuffer[o].push(a))}},{key:"starting",value:function(){this.setState({playing:!0})}},{key:"recomputeBpm",value:function(e){var t=this,n=this.eventsPerSequence;this.eventsPerSequence=0;var a=n/this.state.globalSequenceSize,o=a/this.state.bpmDivider;f.default.Draw.schedule(function(e){return t.setState({eventsPerSecond:a,currentBpm:o})},e),f.default.Transport.bpm.value=o}},{key:"render",value:function(){var e=this,t=this.state.ordering.map(function(t,n){return[c.default.createElement("li",{key:n,className:"instrument-heading"},k[n]),t.map(function(t,a){return c.default.createElement(j,{key:t,synth:P[n],instrumentIndex:a,eventBuffer:e.eventBuffer,platform:t})})]}),n={ready:this.state.playing},a=c.default.createElement("span",{className:(0,h.default)("loading-sequence",n)},"Waiting ",this.state.globalSequenceSize.toSeconds().toFixed(1)+" ","seconds for first sequence of events..."),o=((0,h.default)("bpm-indicator",{ready:this.state.playing}),c.default.createElement("h1",{className:(0,h.default)("bpm-indicator",n)},c.default.createElement(b.default,{value:this.state.currentBpm,formatValue:function(e){return e.toFixed(2)},duration:600}),c.default.createElement("small",null,"BPM"),c.default.createElement("div",null,this.state.eventsPerSecond.toFixed(1)+" ","errors ∕ second ÷ ",this.state.bpmDivider)));return c.default.createElement("div",{id:"sentry_echo"},q,c.default.createElement("div",{className:"main-app"},a,o,c.default.createElement("ul",{className:"sequencers"},t)))}}]),t}(d.Component);t.default=z},"./src/index.js":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var o=n("./node_modules/react/index.js"),r=a(o),i=n("./node_modules/react-dom/index.js"),s=a(i),l=n("./src/App.js"),d=a(l);n("./src/index.scss");var c=new EventSource("https://live.sentry.io:7000");s.default.render(r.default.createElement(d.default,{eventStream:c}),document.getElementById("root"))},"./src/index.scss":function(e,t,n){var a=n("./node_modules/css-loader/index.js!./node_modules/sass-loader/lib/loader.js!./src/index.scss");"string"==typeof a&&(a=[[e.i,a,""]]);var o={hmr:!0};o.transform=void 0;var r=n("./node_modules/style-loader/lib/addStyles.js")(a,o);a.locals&&(e.exports=a.locals),a.locals||e.hot.accept("./node_modules/css-loader/index.js!./node_modules/sass-loader/lib/loader.js!./src/index.scss",function(){var t=n("./node_modules/css-loader/index.js!./node_modules/sass-loader/lib/loader.js!./src/index.scss");"string"==typeof t&&(t=[[e.i,t,""]]),r(t)}),e.hot.dispose(function(){r()})}},["./src/index.js"]);
//# sourceMappingURL=main.0869b6a09b7ace94ecad.js.map