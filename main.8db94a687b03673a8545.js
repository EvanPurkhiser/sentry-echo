webpackJsonp([1],{"./node_modules/css-loader/index.js!./node_modules/sass-loader/lib/loader.js!./src/index.scss":function(e,t,n){t=e.exports=n("./node_modules/css-loader/lib/css-base.js")(void 0),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Raleway:100,200,300);",""]),t.i(n("./node_modules/css-loader/index.js!./node_modules/platformicons/platformicons/platformicons.css"),""),t.i(n("./node_modules/css-loader/index.js!./node_modules/typeface-rubik/index.css"),""),t.push([e.i,'.platform-icon:before{height:50px;width:50px;font-family:platformicons;color:#fff;font-size:32px;-webkit-font-smoothing:antialiased;display:block;height:100%;border-radius:3px 0 0 3px;text-align:center;line-height:48px}.c:before{content:"C";font-family:Raleway;font-weight:300;background:#a9b9cb;line-height:50px}.cocoa:before{content:"\\E60A";background:red}.csharp:before{content:"\\E60F";background:#0090ff}.elixir:before{content:"\\E903";background:#4e3fb4}.go:before{content:"\\E606";background:#fff;color:#000}.java:before{content:"\\E608";background:#ff8a00}.javascript:before{content:"\\E600";background:#ffd906}.node:before{content:"\\E609";background:#8ac655}.objc:before{content:"\\E60E";background:#02bfd0}.php:before{content:"\\E601";background:#4f5b93}.python:before{content:"\\E602";background:#3776ab}.ruby:before{content:"\\E604";background:#d00202}.perl:before{content:"\\E901";background:#9d95a4}.other:before{content:"\\E60A";background:#afafaf}#root,body,html{height:100%}#root,#sentry_echo,body{min-height:100%;margin:0;padding:0}body{background:#15121c;color:#fff;font-family:Rubik;font-weight:300}a{color:#6c5fc7;text-decoration:none;transition:color .3s}a:hover{color:#423b87}#sentry_echo,header{display:flex;flex-direction:column}header{flex-grow:0;padding:20px 0;text-align:center}header p{padding-top:25px;width:570px;line-height:1.9em;margin:0 auto;font-size:.9rem;color:#fff;animation:flavorText 10s linear 1 forwards}@keyframes flavorText{50%{opacity:1}to{opacity:.25}}.logo{display:flex;font-family:Raleway;margin:0 auto}.logo h1:first-child{width:200px;height:70px;background:url("https://sentry-brand.storage.googleapis.com/sentry-logo-white.svg") no-repeat;text-indent:-9999px}.logo h1:last-child{font-weight:100;text-transform:lowercase;line-height:68px;position:relative}.main-app{position:relative;flex-grow:1;display:flex;justify-content:center;padding:80px 0}.sequencers{list-style:none;margin:0;padding:0}.sequencers li:not(:last-child){margin-bottom:8px}.platform{display:flex;width:800px;transition:opacity .5s,filter .5s}.platform.muted{opacity:.2}.instrument-heading{display:flex;text-transform:uppercase;font-size:.8rem;align-items:center;padding:4px 0;user-select:none}.instrument-heading:after{content:"";border-bottom:1px solid #333;flex-grow:1;margin-left:10px}.note-indicator{display:block;width:4px;background:#353042;margin-left:6px;transition:background .3s}.note-indicator.trigger{background:#f36e4f}@keyframes noteIndicatorTrigger{20%{background:#e03e2f}}.sequence-timeline{overflow:hidden;position:relative;margin-left:6px;background:hsla(0,0%,100%,.01);flex-grow:1}.sequence-timeline svg{display:block;shape-rendering:crispEdges}.sequence-timeline svg .bar-lines line{stroke-width:1px;stroke:#2a2140}.sequence-timeline svg .playlist rect{fill:#9990ab;opacity:0;transform:translateX(8px);animation:showNote .4s;animation-fill-mode:forwards}.sequence-timeline svg .playlist rect:first-child,.sequence-timeline svg .playlist rect:nth-child(2){animation-delay:90ms}.sequence-timeline svg .playlist rect:nth-child(3),.sequence-timeline svg .playlist rect:nth-child(4){animation-delay:.18s}.sequence-timeline svg .playlist rect:nth-child(5),.sequence-timeline svg .playlist rect:nth-child(6){animation-delay:.27s}.sequence-timeline svg .playlist rect:nth-child(7),.sequence-timeline svg .playlist rect:nth-child(8){animation-delay:.36s}.sequence-timeline svg .playlist rect:nth-child(9),.sequence-timeline svg .playlist rect:nth-child(10){animation-delay:.45s}.sequence-timeline svg .playlist rect:nth-child(11),.sequence-timeline svg .playlist rect:nth-child(12){animation-delay:.54s}.sequence-timeline svg .playlist rect:nth-child(13),.sequence-timeline svg .playlist rect:nth-child(14){animation-delay:.63s}.sequence-timeline svg .playlist rect:nth-child(15),.sequence-timeline svg .playlist rect:nth-child(16){animation-delay:.72s}.sequence-timeline svg .playlist rect:nth-child(17),.sequence-timeline svg .playlist rect:nth-child(18){animation-delay:.81s}.sequence-timeline svg .playlist rect:nth-child(19),.sequence-timeline svg .playlist rect:nth-child(20){animation-delay:.9s}.sequence-timeline svg .playlist rect:nth-child(21),.sequence-timeline svg .playlist rect:nth-child(22){animation-delay:.99s}.sequence-timeline svg .playlist rect:nth-child(23),.sequence-timeline svg .playlist rect:nth-child(24){animation-delay:1.08s}.sequence-timeline svg .playlist rect:nth-child(25),.sequence-timeline svg .playlist rect:nth-child(26){animation-delay:1.17s}.sequence-timeline svg .playlist rect:nth-child(27),.sequence-timeline svg .playlist rect:nth-child(28){animation-delay:1.26s}.sequence-timeline svg .playlist rect:nth-child(29),.sequence-timeline svg .playlist rect:nth-child(30){animation-delay:1.35s}.sequence-timeline svg .playlist rect:nth-child(31),.sequence-timeline svg .playlist rect:nth-child(32){animation-delay:1.44s}@keyframes showNote{60%{opacity:1}to{opacity:1;transform:translateX(0)}}.playhead{top:0;left:0;border-right:1px solid #6c5fc7;transform:translateX(0);opacity:0;transition:opacity .1s;z-index:2}.playhead,.playhead:before{position:absolute;height:100%}.playhead:before{content:"";display:block;width:10px;left:-10px;background:linear-gradient(90deg,rgba(108,95,199,0),rgba(108,95,199,.2))}.playhead.shown{opacity:1}.bpm-indicator{position:absolute;top:10px;font-weight:400;font-size:1.2rem;line-height:1.2rem;text-align:center;color:#f58159;transition:opacity .6s,transform .6s;opacity:0;transform:translateY(47px);pointer-events:none}.bpm-indicator.ready{opacity:1;transform:translateY(0)}.bpm-indicator div,.bpm-indicator small{color:#fff;font-weight:100}.bpm-indicator small{font-size:.65rem;margin-left:2px}.bpm-indicator div{font-size:.8rem;opacity:.6}.loading-sequence{position:absolute;top:20px;background:#e03e2f;font-size:.8rem;padding:5px 10px;border-radius:3px;animation:waitNotify 1s;transition:opacity .6s}.loading-sequence.ready{opacity:0;pointer-events:none}@keyframes waitNotify{0%{opacity:0}60%{opacity:0}to{opacity:1}}.help-popover{position:absolute;top:0;right:0;height:0}.help-popover .popover{width:600px;padding:40px;background:#fff;color:#342c3e;z-index:10;position:relative;border-radius:4px;top:90px;right:18px;font-size:.9rem;line-height:1.5rem;box-shadow:0 50px 100px rgba(50,50,93,.1),0 15px 35px rgba(50,50,93,.15),0 5px 15px rgba(0,0,0,.1);pointer-events:none;transform:rotate3d(1,1,0,15deg);transform-origin:100% 0;opacity:0;will-change:transform,opacity;transition-property:transform,opacity;transition-duration:.25s}.help-popover .popover:after{display:block;content:"";border:10px solid transparent;border-bottom-color:#fff;height:0;width:0;position:absolute;top:-20px;right:24px}.help-popover h1{margin:8px 0;font-size:.8rem;font-weight:600;text-transform:uppercase}.help-popover span{position:absolute;top:40px;right:40px;line-height:23px;width:25px;display:block;border-radius:50%;text-align:center;font-weight:100;color:hsla(0,0%,100%,.4);font-size:.9rem;padding-top:2px;cursor:pointer;transition:background .3s,color .3s}.help-popover.opened span,.help-popover span:hover{background:#fff;color:#a69db9}.help-popover.opened .popover{transform:none;opacity:1;pointer-events:auto}.help-popover p::selection{background:#d1cbe6}',""])},"./src/App.js":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l=function(){function e(e,t){var n=[],a=!0,o=!1,i=void 0;try{for(var r,s=e[Symbol.iterator]();!(a=(r=s.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=n("./node_modules/react/index.js"),u=a(d),p=n("./node_modules/tone/build/Tone.js"),h=a(p),f=n("./node_modules/classnames/index.js"),m=a(f),y=n("./node_modules/animejs/anime.min.js"),g=a(y),v=n("./node_modules/react-animated-number/build/index.js"),b=a(v),x=n("./node_modules/lodash/lodash.js"),w=a(x);n("./src/index.scss");var k=n("./src/how-it-works.svg"),E=a(k),q=["javascript","node","python","ruby","cocoa","csharp","elixir","go","java","objc","php","perl","c","other"];h.default.Transport.start("+1"),h.default.Transport.bpm.value=160,window.Tone=h.default;var S=["Lead Synth","Kick Drum","Bass Line"],j=["C","D","E","F","G","A","B"],_=[["javascript","python","node","php"],["go","csharp","ruby"],["java","elixir","c","other"]];q=w.default.flatten(_);var M=[{javascript:(new h.default.PluckSynth).toMaster(),python:(new h.default.PluckSynth).toMaster(),node:(new h.default.PluckSynth).toMaster(),php:(new h.default.PluckSynth).toMaster()},{go:(new h.default.MembraneSynth).toMaster(),csharp:(new h.default.MembraneSynth).toMaster(),ruby:(new h.default.MembraneSynth).toMaster()},{java:(new h.default.FMSynth).toMaster(),elixir:(new h.default.FMSynth).toMaster(),c:(new h.default.FMSynth).toMaster(),other:(new h.default.FMSynth).toMaster()}],P={javascript:{countDivision:5,noteLength:"64n",quantizeTo:"8n"},python:{countDivision:5,noteLength:"64n",quantizeTo:"8n",offset:"16n"},php:{countDivision:6,noteLength:"16n",quantizeTo:"4n",offset:"14n",startMuted:!0},csharp:{offset:"8n"},ruby:{startMuted:!0},java:{countDivision:4,noteLength:"32n",quantizeTo:"1:0"},elixir:{countDivision:1,noteLength:"32n",quantizeTo:"0:2"}},z=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),c(t,[{key:"makeBarGrid",value:function(){var e=this,t=h.default.Time("1:0:0").div(this.props.sequenceSize).mult(this.props.width).toSeconds(),n=Math.floor(this.props.width/t);return w.default.times(n,function(n){return u.default.createElement("line",{key:n,x1:Math.floor(t*(n+1)),x2:Math.floor(t*(n+1)),y1:0,y2:e.props.height})})}},{key:"makeNote",value:function(e){var t=this.props.height/j.length-4,n=e.length.clone().div(this.props.sequenceSize).mult(this.props.width).toSeconds(),a=Math.max(1,n),o=e.relTime.clone().div(this.props.sequenceSize).mult(this.props.width).toSeconds()+1,i=Math.floor(e.scaleIndex*(this.props.height/j.length))+2;return u.default.createElement("rect",{key:e.time.toSeconds(),height:t,width:a,x:o,y:i})}},{key:"makePlaylist",value:function(){var e=this;return this.props.playlist.map(function(t){return e.makeNote(t)})}},{key:"render",value:function(){return u.default.createElement("svg",{width:this.props.width,height:this.props.height},u.default.createElement("g",{className:"bar-lines"},this.makeBarGrid()),u.default.createElement("g",{className:"playlist"},this.makePlaylist()))}}]),t}(d.Component),T=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={isMuted:!1,playheadShown:!1,playlist:[]},e.timeline=null,e.playhead=null,e.playheadAnim=null,e.noteIndicator=null,e.playingNotes=0,e.mute=e.mute.bind(e),e.setPlayhead=e.setPlayhead.bind(e),e.processEvents=e.processEvents.bind(e),e.noteStart=e.noteStart.bind(e),e.noteEnd=e.noteEnd.bind(e),e.updatePlaylist=e.updatePlaylist.bind(e),e}return r(t,e),c(t,[{key:"componentDidMount",value:function(){this.setState({muted:this.props.startMuted}),this.props.synth.volume.value=this.props.startMuted?-100:0;var e=this.props.sequenceSize;new h.default.Loop(this.processEvents,this.props.sequenceSize).start(e)}},{key:"processEvents",value:function(e){var t=this,n=this.props.eventBuffer[this.props.platform].sort();this.props.eventBuffer[this.props.platform]=[];var a=n[0];n=n.map(function(e){return h.default.Time((e-a)/1e3)}),n=n.map(function(e){return e.quantize(t.props.quantizeTo)}),n=n.filter(function(e){return e<t.props.sequenceSize});var o=Object.values(w.default.groupBy(n,function(e){return e.toSeconds()}));n=o.map(function(n){return{relTime:n[0].add(t.props.offset),time:n[0].clone().add(e),length:h.default.Time(n.length/t.props.countDivision).mult(t.props.noteLength)}});var i=Math.floor(Math.random()*(j.length-1));n[0].scaleIndex=i;for(var r=1;r<n.length;r++){var s=n[r],l=n[r-1],c=[-1,1][Math.floor(2*Math.random())];s.scaleIndex=l.time.clone().add(l.length)>s.time?i=Math.abs(i+c)%j.length:i}n.forEach(function(e){var n=""+j[e.scaleIndex]+t.props.instrumentIndex;t.props.synth.triggerAttackRelease(n,e.length,e.time)}),n.forEach(function(e){h.default.Draw.schedule(t.noteStart,e.time),h.default.Draw.schedule(t.noteEnd,e.time.clone().add(e.length))}),h.default.Draw.schedule(function(e){return t.updatePlaylist(n)},e),h.default.Draw.schedule(this.setPlayhead,e)}},{key:"updatePlaylist",value:function(e){this.setState({playlist:e})}},{key:"noteStart",value:function(){this.playingNotes++,this.noteIndicator.classList.add("trigger")}},{key:"noteEnd",value:function(){1==this.playingNotes--&&this.noteIndicator.classList.remove("trigger")}},{key:"setPlayhead",value:function(){this.setState({playheadShown:!0}),g.default.remove(this.playhead),this.playhead.style.transform="translateX(0)",this.playheadAnim=(0,g.default)({targets:this.playhead,duration:this.props.sequenceSize.toMilliseconds(),translateX:this.timeline.clientWidth,easing:"linear"})}},{key:"mute",value:function(){var e=!this.state.muted;this.setState({muted:e}),this.props.synth.volume.value=e?-100:0}},{key:"render",value:function(){var e=this;return u.default.createElement("li",{className:(0,m.default)("platform",{muted:this.state.muted}),onClick:this.mute},u.default.createElement("span",{className:(0,m.default)("platform-icon",this.props.platform)}),u.default.createElement("span",{className:"note-indicator",ref:function(t){return e.noteIndicator=t}}),u.default.createElement("div",{className:"sequence-timeline",ref:function(t){return e.timeline=t}},u.default.createElement("span",{className:(0,m.default)("playhead",{shown:this.state.playheadShown}),ref:function(t){return e.playhead=t}}),u.default.createElement(z,{playlist:this.state.playlist,sequenceSize:this.props.sequenceSize,width:734,height:48})))}}]),t}(d.Component);T.defaultProps={countDivision:5,noteLength:"64n",quantizeTo:"2n",offset:0};var N=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={opened:!1},e}return r(t,e),c(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",function(t){e.popover.contains(t.target)||e.setState({opened:!1})})}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{className:(0,m.default)("help-popover",{opened:this.state.opened}),ref:function(t){return e.popover=t}},u.default.createElement("span",{onClick:function(t){return e.setState({opened:!e.state.opened})}},"?"),u.default.createElement("div",{className:"popover"},u.default.createElement("h1",null,"What is this?"),u.default.createElement("p",null,"Sentry echo is a Winter 2017 hack-week project that sprung about from wanting to play with the live data available through ",u.default.createElement("a",{href:"http://live.sentry.io"},"live.sentry.io"),".  Echo generates music using the live stream of errors collected by sentry, placing notes onto a sequence using the error timestamp and it's platform."),u.default.createElement("p",null,"Sentry echo was created by Evan Purkhiser."),u.default.createElement("h1",null,"How does it work?"),u.default.createElement("p",null,"Errors are collected over the HTTP Message Stream ",u.default.createElement("a",{href:"http://live.sentry.io:7000"},"live.sentry.io:7000")," and buffered into platform groups. We then sequence the errors collected over a 4 musical bar period onto a scale. We then do some manipulations based on the timestamp of the event to algin them onto the sequence."),u.default.createElement("p",null,u.default.createElement("img",{src:E.default})),u.default.createElement("p",null,"The BPM for each sequence is computed by taking the total number of errors collected during that period, comuputing the rate of errors per second, and dividing that by a constant to get a sane BPM.")))}}]),t}(d.Component),B=u.default.createElement("header",null,u.default.createElement("div",{className:"logo"},u.default.createElement("h1",null,"Sentry"),u.default.createElement("h1",null,"Echo")),u.default.createElement("p",null,"Listen the beautiful soundscape generated by software breaking around the world. Hear the sound of errors — Powered by sentry.io")),D=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={globalSequenceSize:h.default.Time("4:0:0"),ordering:w.default.cloneDeep(_),bpmDivider:6,currentBpm:new Number(0),eventsPerSecond:new Number(0)},e.eventBuffer=w.default.fromPairs(q.map(function(e){return[e,[]]})),e.eventsPerSequence=0,e.starting=e.starting.bind(e),e.recomputeBpm=e.recomputeBpm.bind(e),e}return r(t,e),c(t,[{key:"componentDidMount",value:function(){var e=this;this.props.eventStream.onmessage=this.processEvents.bind(this);var t=this.state.globalSequenceSize;h.default.Transport.scheduleOnce(function(t){return h.default.Draw.schedule(e.starting,t)},t);var n=t.clone().sub("1i");new h.default.Loop(this.recomputeBpm,this.state.globalSequenceSize).start(n)}},{key:"processEvents",value:function(e){var t=JSON.parse(e.data),n=l(t,4),a=(n[0],n[1],n[2]),o=n[3];void 0!==this.eventBuffer[o]&&(this.eventsPerSequence++,this.eventBuffer[o].push(a))}},{key:"starting",value:function(){this.setState({playing:!0})}},{key:"recomputeBpm",value:function(e){var t=this,n=this.eventsPerSequence;this.eventsPerSequence=0;var a=n/this.state.globalSequenceSize,o=a/this.state.bpmDivider;h.default.Draw.schedule(function(e){return t.setState({eventsPerSecond:a,currentBpm:o})},e),h.default.Transport.bpm.value=o}},{key:"render",value:function(){var e=this,t=this.state.ordering.map(function(t,n){return[u.default.createElement("li",{key:n,className:"instrument-heading"},S[n]),t.map(function(t,a){return u.default.createElement(T,s({key:t},P[t],{synth:M[n][t],instrumentIndex:a+2,sequenceSize:e.state.globalSequenceSize,eventBuffer:e.eventBuffer,platform:t}))})]}),n={ready:this.state.playing},a=u.default.createElement("span",{className:(0,m.default)("loading-sequence",n)},"Waiting ",this.state.globalSequenceSize.toSeconds().toFixed(1)+" ","seconds for first sequence of events..."),o=((0,m.default)("bpm-indicator",{ready:this.state.playing}),u.default.createElement("h1",{className:(0,m.default)("bpm-indicator",n)},u.default.createElement(b.default,{value:this.state.currentBpm,formatValue:function(e){return e.toFixed(2)},duration:600}),u.default.createElement("small",null,"BPM"),u.default.createElement("div",null,this.state.eventsPerSecond.toFixed(1)+" ","errors ∕ second ÷ ",this.state.bpmDivider)));return u.default.createElement("div",{id:"sentry_echo"},B,u.default.createElement(N,null),u.default.createElement("div",{className:"main-app"},a,o,u.default.createElement("ul",{className:"sequencers"},t)))}}]),t}(d.Component);t.default=D},"./src/how-it-works.svg":function(e,t,n){e.exports=n.p+"77787333af8eca0b5a2b27444df0a7f9.svg"},"./src/index.js":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var o=n("./node_modules/react/index.js"),i=a(o),r=n("./node_modules/react-dom/index.js"),s=a(r),l=n("./src/App.js"),c=a(l);n("./src/index.scss");var d=new EventSource("https://live.sentry.io/stream");s.default.render(i.default.createElement(c.default,{eventStream:d}),document.getElementById("root"))},"./src/index.scss":function(e,t,n){var a=n("./node_modules/css-loader/index.js!./node_modules/sass-loader/lib/loader.js!./src/index.scss");"string"==typeof a&&(a=[[e.i,a,""]]);var o={hmr:!0};o.transform=void 0;var i=n("./node_modules/style-loader/lib/addStyles.js")(a,o);a.locals&&(e.exports=a.locals),a.locals||e.hot.accept("./node_modules/css-loader/index.js!./node_modules/sass-loader/lib/loader.js!./src/index.scss",function(){var t=n("./node_modules/css-loader/index.js!./node_modules/sass-loader/lib/loader.js!./src/index.scss");"string"==typeof t&&(t=[[e.i,t,""]]),i(t)}),e.hot.dispose(function(){i()})}},["./src/index.js"]);
//# sourceMappingURL=main.8db94a687b03673a8545.js.map